# Captioner Translate

åŸºäº OpenAI API çš„æ™ºèƒ½å­—å¹•ç¿»è¯‘å·¥å…·ï¼Œæ”¯æŒå°†è‹±æ–‡å­—å¹•ç¿»è¯‘æˆä¸­æ–‡å¹¶ç”ŸæˆåŒè¯­å­—å¹•æ–‡ä»¶ã€‚

**ğŸ“– æ–‡æ¡£è¯­è¨€:**
- **[English Documentation](README.md)**
- **ä¸­æ–‡æ–‡æ¡£** (å½“å‰)

## âœ¨ ç‰¹æ€§

- ğŸ¯ **æ™ºèƒ½å­—å¹•å¤„ç†**: æ”¯æŒ SRT æ ¼å¼ï¼Œè‡ªåŠ¨ç”ŸæˆåŒè¯­ ASS å­—å¹•
- ğŸ”„ **é«˜è´¨é‡ç¿»è¯‘**: ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç¿»è¯‘ï¼Œæ”¯æŒåæ€æ¨¡å¼æå‡å‡†ç¡®æ€§
- ğŸš€ **é«˜æ•ˆå¤„ç†**: å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ï¼Œæ”¯æŒæ‰¹é‡ç¿»è¯‘
- ğŸŒ **å¤šç§ API æ”¯æŒ**: å…¼å®¹ OpenAIã€OpenRouter å’Œå…¶ä»– OpenAI å…¼å®¹çš„ API
- ğŸ“ **ä¸“ä¸šè¾“å‡º**: ç”Ÿæˆé€‚ç”¨äºè§†é¢‘æ’­æ”¾å™¨çš„æ ¼å¼åŒ–åŒè¯­ ASS æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- OpenAI API å¯†é’¥æˆ–å…¼å®¹çš„ API æœåŠ¡

### å®‰è£…

```bash
# å¦‚æœè¿˜æ²¡æœ‰å®‰è£… uvï¼Œå…ˆå®‰è£… uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# å…‹éš†é¡¹ç›®
git clone https://github.com/yangping4271/Captioner_Translate.git
cd Captioner_Translate

# å®‰è£…ä¸ºå…¨å±€å·¥å…·
uv tool install .
```

### é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½® APIï¼š

```bash
# OpenAI API é…ç½®
OPENAI_API_KEY=your_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1
LLM_MODEL=gpt-4o-mini

# æˆ–è€…ä½¿ç”¨ OpenRouter é…ç½®
# OPENAI_API_KEY=sk-or-v1-your_openrouter_key
# OPENAI_BASE_URL=https://openrouter.ai/api/v1
# LLM_MODEL=openai/gpt-4o-mini
```

### åŸºæœ¬ä½¿ç”¨

å®‰è£…å®Œæˆåï¼Œæ‚¨å¯ä»¥åœ¨ä»»ä½•ç›®å½•ä¸­å…¨å±€ä½¿ç”¨ `translate` å‘½ä»¤ï¼š

```bash
# å¯¼èˆªåˆ°åŒ…å« .srt æ–‡ä»¶çš„ç›®å½•ï¼Œç„¶åç¿»è¯‘
cd /path/to/your/subtitle/files
translate

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é€‰é¡¹
translate --help
```

## ğŸ“ æ–‡ä»¶å¤„ç†æµç¨‹

å·¥å…·è‡ªåŠ¨æ‰«æå½“å‰å·¥ä½œç›®å½•å¹¶å¤„ç†æ‰€æœ‰ `.srt` æ–‡ä»¶ï¼š

1. **å‘ç°**: æ‰«æå½“å‰ç›®å½•ä¸­çš„ `.srt` å­—å¹•æ–‡ä»¶
2. **å¤„ç†**:
   - ç”Ÿæˆ `_en.srt`ï¼ˆä¼˜åŒ–åçš„è‹±æ–‡å­—å¹•ï¼‰
   - ç”Ÿæˆ `_zh.srt`ï¼ˆä¸­æ–‡ç¿»è¯‘ï¼‰
3. **è¾“å‡º**: åŒè¯­ `.ass` å­—å¹•æ–‡ä»¶
4. **æ¸…ç†**: è‡ªåŠ¨åˆ é™¤ä¸­é—´æ–‡ä»¶

### æ”¯æŒçš„æ–‡ä»¶æ¨¡å¼

- `filename.srt` â†’ `filename_en.srt` + `filename_zh.srt` â†’ `filename.ass`
- `filename_en.srt` â†’ `filename_zh.srt` â†’ `filename.ass`
- å·²æœ‰ `.ass` è¾“å‡ºçš„æ–‡ä»¶ä¼šè‡ªåŠ¨è·³è¿‡

## ğŸ”§ å‘½ä»¤å‚è€ƒ

### ä¸»å‘½ä»¤

- `translate`: ç¿»è¯‘å½“å‰å·¥ä½œç›®å½•ä¸­çš„æ‰€æœ‰å­—å¹•æ–‡ä»¶ï¼ˆå®‰è£…åå…¨å±€å¯ç”¨ï¼‰

### é€‰é¡¹

- `-r, --reflect`: å¯ç”¨åæ€ç¿»è¯‘æ¨¡å¼ä»¥è·å¾—æ›´é«˜è´¨é‡
- `-m, --model TEXT`: æŒ‡å®šè¦ä½¿ç”¨çš„ LLM æ¨¡å‹
- `-d, --debug`: å¯ç”¨è°ƒè¯•æ—¥å¿—ä»¥è·å¾—è¯¦ç»†çš„å¤„ç†ä¿¡æ¯
- `--project-root PATH`: Captioner_Translate é¡¹ç›®æ ¹ç›®å½•è·¯å¾„
- `--version, -v`: æ˜¾ç¤ºç‰ˆæœ¬å¹¶é€€å‡º

### ä½¿ç”¨ç¤ºä¾‹

```bash
# ç¿»è¯‘å½“å‰ç›®å½•ä¸­æ‰€æœ‰ .srt æ–‡ä»¶
translate

# ä½¿ç”¨åæ€æ¨¡å¼è¿›è¡Œé«˜è´¨é‡ç¿»è¯‘
translate -r

# ä½¿ç”¨ç‰¹å®šæ¨¡å‹ (GPT-4)
translate -m gpt-4

# å¯ç”¨è°ƒè¯•è¾“å‡º
translate -d

# ç»„åˆæ‰€æœ‰é€‰é¡¹ä»¥è·å¾—æœ€é«˜è´¨é‡
translate -r -m gpt-4o -d
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
captioner_translate/
â”œâ”€â”€ captioner_translate/          # ä¸» CLI åŒ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli.py                   # Typer CLI æ¥å£
â”‚   â”œâ”€â”€ core.py                  # æ ¸å¿ƒç¿»è¯‘é€»è¾‘
â”‚   â””â”€â”€ translator.py            # ç¿»è¯‘æ¨¡å—
â”œâ”€â”€ subtitle_processor/          # å­—å¹•å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ data.py                 # æ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ optimizer.py            # ç¿»è¯‘ä¼˜åŒ–
â”‚   â”œâ”€â”€ prompts.py              # AI æç¤ºè¯
â”‚   â”œâ”€â”€ split_by_llm.py         # LLM æ–‡æœ¬åˆ†å‰²
â”‚   â”œâ”€â”€ spliter.py              # å­—å¹•åˆ†å‰²
â”‚   â””â”€â”€ summarizer.py           # å†…å®¹æ‘˜è¦
â”œâ”€â”€ utils/                      # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ json_repair.py          # JSON è§£æå·¥å…·
â”‚   â”œâ”€â”€ logger.py               # æ—¥å¿—é…ç½®
â”‚   â”œâ”€â”€ srt2ass.py              # SRT åˆ° ASS è½¬æ¢å™¨
â”‚   â””â”€â”€ test_opanai.py          # API æµ‹è¯•å·¥å…·
â”œâ”€â”€ test_subtitles/             # ç¤ºä¾‹å­—å¹•æ–‡ä»¶
â”œâ”€â”€ logs/                       # åº”ç”¨æ—¥å¿—
â”œâ”€â”€ .env                        # ç¯å¢ƒé…ç½®
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®
â”œâ”€â”€ README.md                   # è‹±æ–‡æ–‡æ¡£
â””â”€â”€ README_zh.md                # ä¸­æ–‡æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

## ğŸŒ API å…¼å®¹æ€§

æœ¬å·¥å…·å…¼å®¹å¤šç§ OpenAI å…¼å®¹çš„ APIï¼š

- **OpenAI**: å®˜æ–¹ OpenAI API
- **OpenRouter**: é€šè¿‡ä¸€ä¸ª API è®¿é—®å¤šä¸ªæ¨¡å‹
- **è‡ªå®šä¹‰ç«¯ç‚¹**: ä»»ä½• OpenAI å…¼å®¹çš„ API æœåŠ¡

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

- **API å¯†é’¥é—®é¢˜**: ç¡®ä¿ `.env` æ–‡ä»¶é…ç½®æ­£ç¡®ä¸” API å¯†é’¥æœ‰æ•ˆ
- **æ¨¡å‹æœªæ‰¾åˆ°**: æ£€æŸ¥æŒ‡å®šçš„æ¨¡å‹æ˜¯å¦é€šè¿‡æ‚¨çš„ API æä¾›å•†å¯ç”¨

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è°ƒè¯•æ¨¡å¼ä»¥è·å¾—è¯¦ç»†æ—¥å¿—ï¼š
```bash
translate -d
```

## ğŸ“„ è®¸å¯è¯

MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚

---

**ğŸ“– æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ [English Documentation](README.md)**
